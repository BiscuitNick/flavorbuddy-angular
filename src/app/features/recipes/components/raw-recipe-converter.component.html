@if (isLoading()) {
<app-recipe-viewer-skeleton></app-recipe-viewer-skeleton>
} @if (result(); as convertedRecipe) {
<app-recipe-viewer [recipe]="convertedRecipe" [sourceUrl]="displayedSource()" [showConversionWidget]="'text'"></app-recipe-viewer>
}

<section class="space-y-6 print-hidden">
  <div class="space-y-3">
    <h1 class="text-4xl font-bold tracking-tight text-stone-800 flex items-center gap-3">
      <span class="text-4xl">ğŸ“</span>
      Convert Text
    </h1>
    <p class="text-lg text-stone-600 leading-relaxed">
      Transform unstructured recipe text into a beautiful, organized recipe card with ingredients and instructions.
    </p>
  </div>

  <form class="space-y-4" [formGroup]="form" (ngSubmit)="onSubmit()" novalidate>
    <textarea
      id="raw-text"
      formControlName="rawText"
      rows="12"
      placeholder="Copy and paste your recipe text here..."
      class="w-full rounded-xl border-2 border-orange-300 bg-white px-5 py-4 text-base shadow-sm transition focus-visible:border-orange-500 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-orange-200 placeholder:text-stone-400 leading-relaxed"
      [attr.aria-invalid]="form.controls.rawText.invalid && form.controls.rawText.touched"
      [attr.aria-describedby]="
        form.controls.rawText.invalid && form.controls.rawText.touched ? 'raw-text-error' : null
      "
      required
    ></textarea>
    <div class="flex items-center justify-between gap-4">
      <a
        routerLink="/"
        class="inline-flex items-center gap-2 text-base font-semibold text-orange-600 hover:text-orange-700 transition"
      >
        <span>ğŸŒ</span>
        Convert URL â†’
      </a>
      <button
        type="submit"
        class="inline-flex items-center justify-center rounded-xl bg-gradient-to-r from-orange-500 to-orange-600 px-6 py-3.5 font-bold text-white shadow-lg transition hover:-translate-y-0.5 hover:shadow-xl disabled:cursor-not-allowed disabled:from-stone-400 disabled:to-stone-400 disabled:shadow-none"
        [disabled]="form.invalid || isLoading()"
      >
        {{ isLoading() ? 'Convertingâ€¦' : 'Convert' }}
      </button>
    </div>
  </form>

  @if (form.controls.rawText.invalid && form.controls.rawText.touched) {
  <p
    id="raw-text-error"
    class="text-sm font-semibold text-red-600"
    role="alert"
    aria-live="assertive"
  >
    Recipe text is required.
  </p>
  } @if (result()) {
  <button
    type="button"
    class="text-base font-semibold text-orange-600 hover:text-orange-700 transition"
    (click)="clearResult()"
  >
    Clear result
  </button>
  } @if (isLoading()) {
  <span class="text-base text-stone-600 font-medium">ğŸ³ Cooking up your recipeâ€¦</span>
  } @if (errorMessage(); as error) {
  <div
    class="rounded-xl border-2 border-red-300 bg-red-50 px-5 py-4 text-base font-medium text-red-800 shadow-sm"
    role="alert"
  >
    {{ error }}
  </div>
  }
</section>

<div class="print-hidden">
  <!-- <a
    routerLink="/"
    class="inline-flex items-center gap-2 text-sm font-semibold text-blue-600 hover:text-blue-700"
  >
    Back to URL converter â†’
  </a> -->
</div>
